/*
 * DCC Security Configuration for AllThingsLinux IRC Network
 * ========================================================
 * 
 * This configuration uses a "default deny, explicit allow" approach for maximum security.
 * All files are blocked by default, then we explicitly allow safe file types.
 * 
 * SECURITY PHILOSOPHY:
 * - Better to be restrictive and secure than permissive and vulnerable
 * - Users can use /DCCALLOW to override restrictions for trusted senders
 * - Operators can adjust this policy based on network needs
 * 
 * WARNING: Even "safe" file types can potentially contain exploits.
 * This configuration provides reasonable protection while maintaining usability.
 */

/* ============================================================================
 * SECURITY POLICY: Default Deny All Files
 * ============================================================================ */
deny dcc { filename "*"; reason "File transfer blocked for security. Use /DCCALLOW to allow trusted senders."; soft yes; }

/* ============================================================================
 * ALLOWED FILE TYPES: Images (Generally Safe)
 * ============================================================================ */
allow dcc { filename "*.jpg"; soft yes; }
allow dcc { filename "*.jpeg"; soft yes; }
allow dcc { filename "*.gif"; soft yes; }
allow dcc { filename "*.png"; soft yes; }
allow dcc { filename "*.bmp"; soft yes; }
allow dcc { filename "*.webp"; soft yes; }
allow dcc { filename "*.svg"; soft yes; }
allow dcc { filename "*.ico"; soft yes; }
allow dcc { filename "*.tiff"; soft yes; }
allow dcc { filename "*.tif"; soft yes; }

/* ============================================================================
 * ALLOWED FILE TYPES: Audio Files (No Playlists/Scripts)
 * ============================================================================ */
allow dcc { filename "*.mp3"; soft yes; }
allow dcc { filename "*.wav"; soft yes; }
allow dcc { filename "*.flac"; soft yes; }
allow dcc { filename "*.ogg"; soft yes; }
allow dcc { filename "*.m4a"; soft yes; }
allow dcc { filename "*.aac"; soft yes; }
allow dcc { filename "*.wma"; soft yes; }

/* ============================================================================
 * ALLOWED FILE TYPES: Video Files (No Scripts/Executables)
 * ============================================================================ */
allow dcc { filename "*.mp4"; soft yes; }
allow dcc { filename "*.avi"; soft yes; }
allow dcc { filename "*.mkv"; soft yes; }
allow dcc { filename "*.mov"; soft yes; }
allow dcc { filename "*.wmv"; soft yes; }
allow dcc { filename "*.flv"; soft yes; }
allow dcc { filename "*.webm"; soft yes; }
allow dcc { filename "*.m4v"; soft yes; }
allow dcc { filename "*.mpg"; soft yes; }
allow dcc { filename "*.mpeg"; soft yes; }

/* ============================================================================
 * ALLOWED FILE TYPES: Documents and Text Files
 * ============================================================================ */
allow dcc { filename "*.txt"; soft yes; }
allow dcc { filename "*.log"; soft yes; }
allow dcc { filename "*.md"; soft yes; }
allow dcc { filename "*.rst"; soft yes; }
allow dcc { filename "*.pdf"; soft yes; }
allow dcc { filename "*.rtf"; soft yes; }

/* ============================================================================
 * ALLOWED FILE TYPES: Source Code Files (Text-based)
 * ============================================================================ */
allow dcc { filename "*.c"; soft yes; }
allow dcc { filename "*.cpp"; soft yes; }
allow dcc { filename "*.h"; soft yes; }
allow dcc { filename "*.hpp"; soft yes; }
allow dcc { filename "*.py"; soft yes; }
allow dcc { filename "*.js"; soft yes; }
allow dcc { filename "*.css"; soft yes; }
allow dcc { filename "*.html"; soft yes; }
allow dcc { filename "*.xml"; soft yes; }
allow dcc { filename "*.json"; soft yes; }
allow dcc { filename "*.yaml"; soft yes; }
allow dcc { filename "*.yml"; soft yes; }
allow dcc { filename "*.go"; soft yes; }
allow dcc { filename "*.rs"; soft yes; }
allow dcc { filename "*.java"; soft yes; }
allow dcc { filename "*.php"; soft yes; }
allow dcc { filename "*.rb"; soft yes; }
allow dcc { filename "*.pl"; soft yes; }
allow dcc { filename "*.sh"; soft yes; }

/* ============================================================================
 * BLOCKED FILE TYPES: Potentially Dangerous (Explicit Deny for Clarity)
 * ============================================================================
 * Note: These are already blocked by the default deny rule above,
 * but we list them explicitly for documentation purposes.
 */

/* Executables and Scripts */
/* deny dcc { filename "*.exe"; reason "Executable files not allowed"; soft yes; } */
/* deny dcc { filename "*.com"; reason "Executable files not allowed"; soft yes; } */
/* deny dcc { filename "*.bat"; reason "Batch files not allowed"; soft yes; } */
/* deny dcc { filename "*.cmd"; reason "Command files not allowed"; soft yes; } */
/* deny dcc { filename "*.scr"; reason "Screen savers not allowed"; soft yes; } */
/* deny dcc { filename "*.pif"; reason "Program information files not allowed"; soft yes; } */

/* Archives (can contain executables) */
/* deny dcc { filename "*.zip"; reason "Archives not allowed"; soft yes; } */
/* deny dcc { filename "*.rar"; reason "Archives not allowed"; soft yes; } */
/* deny dcc { filename "*.7z"; reason "Archives not allowed"; soft yes; } */
/* deny dcc { filename "*.tar"; reason "Archives not allowed"; soft yes; } */
/* deny dcc { filename "*.gz"; reason "Archives not allowed"; soft yes; } */

/* Office Documents (can contain macros) */
/* deny dcc { filename "*.doc"; reason "Office documents not allowed"; soft yes; } */
/* deny dcc { filename "*.docx"; reason "Office documents not allowed"; soft yes; } */
/* deny dcc { filename "*.xls"; reason "Office documents not allowed"; soft yes; } */
/* deny dcc { filename "*.xlsx"; reason "Office documents not allowed"; soft yes; } */
/* deny dcc { filename "*.ppt"; reason "Office documents not allowed"; soft yes; } */
/* deny dcc { filename "*.pptx"; reason "Office documents not allowed"; soft yes; } */
